# Checkpoint â€” 2025-10-22 22:30 PT

**Scope**
- Provisioned Terraform remote state infrastructure (S3 bucket `dodeck-terraform-state` with versioning/encryption, DynamoDB table `dodeck-terraform-locks`).
- Added AWS IAM OIDC provider and deploy role `dodeck-service-deploy` with inline permissions for S3/DynamoDB/ECR/App Runner/IAM/SSM.
- Captured configuration in docs (`STATE_SETUP.md`, `DEPLOY_NOTES.md`) and updated decision log/todo list.

**Diff highlights**
- `infra/terraform/STATE_SETUP.md`: instructions reflect remote state + backend config usage.
- `service/DEPLOY_NOTES.md`: CI/CD credential section now references OIDC role and required secrets.
- `docs/agents/decisions.md`: new entry for GitHub OIDC deploy role.
- `docs/agents/todo.md`: updated next actions for GitHub secrets + promotion flow.
- `.github/workflows/service.yml`: deploy job uses backend config secrets and new IAM role (from prior step).

**Evidence**
- `aws s3api create-bucket --bucket dodeck-terraform-state --create-bucket-configuration LocationConstraint=us-west-2`
- `aws s3api put-bucket-versioning --bucket dodeck-terraform-state --versioning-configuration Status=Enabled`
- `aws dynamodb create-table --table-name dodeck-terraform-locks --billing-mode PAY_PER_REQUEST`
- `aws iam create-open-id-connect-provider --url https://token.actions.githubusercontent.com`
- `aws iam create-role --role-name dodeck-service-deploy --assume-role-policy-document file://...`
- `AWS_REGION=us-west-2 terraform -chdir=infra/terraform/envs/dev validate`

**Risks / Follow-ups**
- GitHub repository secrets/variables still need to be populated before first deploy.
- Inline IAM policy should be reviewed against least-privilege once Terraform resource set stabilizes.
- Consider enabling access logs/SSE-KMS on the state bucket for compliance.
